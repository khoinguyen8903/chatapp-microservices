<div class="login-wrapper">
  <!-- Background Shapes -->
  <div class="shape shape-1"></div>
  <div class="shape shape-2"></div>

  <div class="login-card">
    <!-- Header: Logo & Title -->
    <div class="text-center mb-8">
      <div class="logo-container">
        <i class="fas fa-comments"></i>
      </div>
      <h2 class="title">
        {{ isLoginMode() ? 'Chào mừng trở lại' : 'Tạo tài khoản mới' }}
      </h2>
      <p class="subtitle">
        {{ isLoginMode() ? 'Đăng nhập để tiếp tục kết nối' : 'Tham gia cộng đồng chat miễn phí' }}
      </p>
    </div>

    <!-- Form -->
    <form (submit)="onSubmit(); $event.preventDefault()" class="space-y-5">
      
      <!-- Register Fields -->
      @if (!isLoginMode()) {
        <div class="space-y-4 animate-slide-in">
          <div class="form-group">
            <label>Họ và Tên</label>
            <div class="input-wrapper">
              <span class="icon"><i class="fas fa-id-card"></i></span>
              <input 
                type="text" 
                [(ngModel)]="formData.displayName" 
                name="displayName" 
                placeholder="Ví dụ: Nguyễn Văn A" 
                class="input-field"
              >
            </div>
          </div>
          <div class="form-group">
            <label>Email</label>
            <div class="input-wrapper">
              <span class="icon"><i class="fas fa-envelope"></i></span>
              <input 
                type="email" 
                [(ngModel)]="formData.email" 
                name="email" 
                placeholder="name@company.com" 
                class="input-field"
              >
            </div>
          </div>
        </div>
      }

      <!-- Common Fields -->
      <div class="form-group">
        <label>Tài khoản</label>
        <div class="input-wrapper">
          <span class="icon"><i class="fas fa-user"></i></span>
          <input 
            type="text" 
            [(ngModel)]="formData.username" 
            name="username" 
            placeholder="Nhập username" 
            class="input-field" 
            required
          >
        </div>
      </div>

      <div class="form-group">
        <label>Mật khẩu</label>
        <div class="input-wrapper">
          <span class="icon"><i class="fas fa-lock"></i></span>
          <input 
            [type]="showPassword() ? 'text' : 'password'" 
            [(ngModel)]="formData.password" 
            name="password" 
            placeholder="••••••••" 
            class="input-field pr-10" 
            required
          >
          <button 
            type="button" 
            (click)="togglePassword()" 
            class="password-toggle"
            tabindex="-1"
          >
            <i class="fas" [class]="showPassword() ? 'fa-eye-slash' : 'fa-eye'"></i>
          </button>
        </div>
      </div>

      <!-- Confirm Password -->
      @if (!isLoginMode()) {
        <div class="form-group animate-slide-in">
          <label>Xác nhận mật khẩu</label>
          <div class="input-wrapper">
            <span class="icon"><i class="fas fa-check-circle"></i></span>
            <input 
              type="password" 
              [(ngModel)]="formData.confirmPassword" 
              name="confirmPassword" 
              placeholder="••••••••" 
              class="input-field" 
              required
            >
          </div>
        </div>
      }

      <!-- Error Alert -->
      @if (errorMessage()) {
        <div class="error-alert animate-shake">
          <i class="fas fa-exclamation-triangle"></i>
          <span>{{ errorMessage() }}</span>
        </div>
      }

      <!-- Submit Button -->
      <button 
        type="submit" 
        [disabled]="isLoading()"
        class="submit-btn"
      >
        @if (isLoading()) {
          <svg class="spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span>Đang xử lý...</span>
        } @else {
          <span>{{ isLoginMode() ? 'ĐĂNG NHẬP' : 'ĐĂNG KÝ NGAY' }}</span>
          <i class="fas fa-arrow-right ml-1"></i>
        }
      </button>
    </form>

    <!-- Footer -->
    <div class="footer">
      {{ isLoginMode() ? 'Chưa có tài khoản?' : 'Đã có tài khoản?' }}
      <button (click)="toggleMode()" class="toggle-link">
        {{ isLoginMode() ? 'Đăng ký miễn phí' : 'Đăng nhập ngay' }}
      </button>
    </div>
  </div>
</div>