<div class="find-friends-container">
  <!-- Search Section -->
  <div class="search-section">
    <div class="search-box-wrapper">
      <input
        type="text"
        [(ngModel)]="searchKeyword"
        (ngModelChange)="onSearchInput($event)"
        placeholder="T√¨m ki·∫øm ng∆∞·ªùi d√πng (nh·∫≠p √≠t nh·∫•t 3 k√Ω t·ª±)..."
        class="search-input"
      />
      <button
        *ngIf="searchKeyword"
        (click)="clearSearch()"
        class="clear-search-btn"
        title="X√≥a t√¨m ki·∫øm"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
    </div>

    <p *ngIf="searchKeyword.length > 0 && searchKeyword.length < 3" class="search-hint">
      Nh·∫≠p √≠t nh·∫•t 3 k√Ω t·ª± ƒë·ªÉ t√¨m ki·∫øm
    </p>
  </div>

  <!-- Search Loading State -->
  <div *ngIf="searchLoading" class="loading-state">
    <div class="spinner"></div>
    <p>ƒêang t√¨m ki·∫øm...</p>
  </div>

  <!-- Search Results -->
  <div *ngIf="searchResults.length > 0 && !searchLoading" class="section">
    <h2 class="section-title">üîç K·∫øt qu·∫£ t√¨m ki·∫øm ({{ searchResults.length }})</h2>

    <div class="user-grid">
      <div
        *ngFor="let user of searchResults"
        class="user-card"
      >
        <div class="user-avatar">
          <img
            [src]="getAvatarUrl(user.avatarUrl)"
            [alt]="user.fullName"
            class="avatar-image"
          />
        </div>

        <div class="user-info">
          <h3 class="user-name">{{ user.fullName || user.username }}</h3>
          <p class="user-username">@{{ user.username }}</p>
          <p *ngIf="user.mutualFriends" class="mutual-friends">
            {{ user.mutualFriends }} b·∫°n chung
          </p>
          <div *ngIf="getStatusText(user)" [class]="getStatusBadgeClass(user)" class="status-badge">
            {{ getStatusText(user) }}
          </div>
        </div>

        <div class="user-actions">
          <button
            [class.btn-disabled]="isButtonDisabled(user)"
            (click)="isButtonDisabled(user) ? null : sendFriendRequest(user.id, user.username)"
            [disabled]="isButtonDisabled(user)"
            class="btn-request"
            [title]="getButtonText(user)"
          >
            <span class="btn-icon"></span>
            {{ getButtonText(user) }}
          </button>
          <button
            class="btn-profile"
            (click)="viewProfile(user.id)"
            title="Xem h·ªì s∆°"
          >
            <span class="btn-icon">üë§</span>
            Xem h·ªì s∆°
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- No Results -->
  <div *ngIf="searchKeyword.length >= 3 && searchResults.length === 0 && !searchLoading" class="empty-state">
    <span class="empty-icon">üîç</span>
    <h3>Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng n√†o</h3>
    <p>Th·ª≠ t·ª´ kh√≥a kh√°c ho·∫∑c xem g·ª£i √Ω b√™n d∆∞·ªõi</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <span class="error-icon">‚ö†Ô∏è</span>
    <p>{{ error }}</p>
    <button class="btn-retry" (click)="loadRecommendations()">Th·ª≠ l·∫°i</button>
  </div>

  <!-- Recommendations Section -->
  <div *ngIf="!searchKeyword && !error" class="section recommendations-section">
    <h2 class="section-title">‚ú® G·ª£i √Ω k·∫øt b·∫°n</h2>

    <!-- Loading -->
    <div *ngIf="loading" class="loading-state">
      <div class="spinner"></div>
      <p>ƒêang t·∫£i g·ª£i √Ω...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && recommendations.length === 0" class="empty-state">
      <span class="empty-icon">üë•</span>
      <h3>Ch∆∞a c√≥ g·ª£i √Ω n√†o</h3>
      <p>T√¨m ki·∫øm ng∆∞·ªùi d√πng ƒë·ªÉ k·∫øt b·∫°n nh√©!</p>
    </div>

    <!-- Recommendations List -->
    <div *ngIf="!loading && recommendations.length > 0" class="user-grid">
      <div
        *ngFor="let rec of recommendations"
        class="user-card"
      >
        <div class="user-avatar">
          <img
            [src]="getAvatarUrl(rec.avatarUrl)"
            [alt]="rec.fullName"
            class="avatar-image"
          />
        </div>

        <div class="user-info">
          <h3 class="user-name">{{ rec.fullName || rec.username }}</h3>
          <p class="user-username">@{{ rec.username }}</p>
          <p *ngIf="rec.mutualFriends" class="mutual-friends">
            {{ rec.mutualFriends }} b·∫°n chung
          </p>
          <p *ngIf="rec.reason" class="recommendation-reason">
            <span class="reason-label">G·ª£i √Ω:</span> {{ rec.reason }}
          </p>
        </div>

        <div class="user-actions">
          <button
            class="btn-request"
            (click)="sendFriendRequest(rec.id, rec.username)"
            title="G·ª≠i l·ªùi m·ªùi k·∫øt b·∫°n"
          >
            <span class="btn-icon">üì§</span>
            G·ª≠i l·ªùi m·ªùi
          </button>
          <button
            class="btn-profile"
            (click)="viewProfile(rec.id)"
            title="Xem h·ªì s∆°"
          >
            <span class="btn-icon">üë§</span>
            Xem h·ªì s∆°
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

